import{S as ge,i as Ee,s as _e,f as g,g as h,c as _,h as m,j as be,k as l,m as b,t as w,a as v,l as we,d as S,o as ve,e as M}from"./app-6d9f305e.js";import K from"./button-8a7fdb21.js";import Q from"./input-694295df.js";import{r as X}from"./util-f704b04e.js";import Y from"./select-5f1b2e78.js";import"./utils-4fba9a6a.js";import"./tw-merge-0f2443f8.js";import"./icons-c5a046aa.js";class Se{constructor(e,s="user",a=null,o=null){this._webcamElement=e,this._webcamElement.width=this._webcamElement.width||640,this._webcamElement.height=this._webcamElement.height||360,this._facingMode=s,this._webcamList=[],this._streamList=[],this._selectedDeviceId="",this._canvasElement=a,this._snapSoundElement=o}get facingMode(){return this._facingMode}set facingMode(e){this._facingMode=e}get webcamList(){return this._webcamList}get webcamCount(){return this._webcamList.length}get selectedDeviceId(){return this._selectedDeviceId}getVideoInputs(e){return this._webcamList=[],e.forEach(s=>{s.kind==="videoinput"&&this._webcamList.push(s)}),this._webcamList.length==1&&(this._facingMode="user"),this._webcamList}getMediaConstraints(){var e={};this._selectedDeviceId==""?e.facingMode=this._facingMode:e.deviceId={exact:this._selectedDeviceId},e.width={exact:this._webcamElement.width},e.height={exact:this._webcamElement.height};var s={video:e,audio:!1};return s}selectCamera(){for(let e of this._webcamList)if(this._facingMode=="user"&&e.label.toLowerCase().includes("front")||this._facingMode=="enviroment"&&e.label.toLowerCase().includes("back")){this._selectedDeviceId=e.deviceId;break}}flip(){this._facingMode=this._facingMode=="user"?"enviroment":"user",this._webcamElement.style.transform="",this.selectCamera()}async start(e=!0){return new Promise((s,a)=>{this.stop(),navigator.mediaDevices.getUserMedia(this.getMediaConstraints()).then(o=>{this._streamList.push(o),this.info().then($=>{this.selectCamera(),e?this.stream().then(r=>{s(this._facingMode)}).catch(r=>{a(r)}):s(this._selectedDeviceId)}).catch($=>{a($)})}).catch(o=>{a(o)})})}async info(){return new Promise((e,s)=>{navigator.mediaDevices.enumerateDevices().then(a=>{this.getVideoInputs(a),e(this._webcamList)}).catch(a=>{s(a)})})}async stream(){return new Promise((e,s)=>{navigator.mediaDevices.getUserMedia(this.getMediaConstraints()).then(a=>{this._streamList.push(a),this._webcamElement.srcObject=a,this._facingMode=="user"&&(this._webcamElement.style.transform="scale(-1,1)"),this._webcamElement.play(),e(this._facingMode)}).catch(a=>{console.log(a),s(a)})})}stop(){this._streamList.forEach(e=>{e.getTracks().forEach(s=>{s.stop()})})}snap(){if(this._canvasElement!=null){this._snapSoundElement!=null&&this._snapSoundElement.play(),this._canvasElement.height=this._webcamElement.scrollHeight,this._canvasElement.width=this._webcamElement.scrollWidth;let e=this._canvasElement.getContext("2d");return this._facingMode=="user"&&(e.translate(this._canvasElement.width,0),e.scale(-1,1)),e.clearRect(0,0,this._canvasElement.width,this._canvasElement.height),e.drawImage(this._webcamElement,0,0,this._canvasElement.width,this._canvasElement.height),this._canvasElement.toDataURL("image/png")}else throw"canvas element is missing"}}function $e(i){let e,s,a,o,$,r,u,L,p,P,d,G,f,F,E,W,R,H,C,B,y,U,V,T,q,x,D,j,I,t,c,Z,N,A,ee,k,te,O,z,ae={label:"Enter Student First Name"};u=new Q({props:ae}),i[16](u);let ie={label:"Enter Student Surname"};p=new Q({props:ie}),i[17](p);let le={label:"Enter Student Email"};d=new Q({props:le}),i[18](d);let re={label:"Enter Form Number"};f=new Q({props:re}),i[19](f);let oe={options:i[11],placeholder:"Select Program of Study",label:"Select Program of Study",className:"text-sm"};E=new Y({props:oe}),i[20](E);let ce={options:i[9],placeholder:"Select Level",label:"Select Student Level",className:"text-sm"};R=new Y({props:ce}),i[21](R);let me={options:i[10],placeholder:"Select Session",label:"Select Session",className:"text-sm"};return C=new Y({props:me}),i[22](C),D=new K({props:{buttonText:"Save Student Info"}}),D.$on("click",i[15]),A=new K({props:{buttonText:"Start Webcam",className:"max-w-fit"}}),A.$on("click",i[12]),k=new K({props:{buttonText:"Capture",className:"max-w-fit"}}),k.$on("click",i[13]),O=new K({props:{buttonText:"Stop Webcam",className:"max-w-fit"}}),O.$on("click",i[14]),{c(){e=g("div"),s=g("div"),a=g("div"),o=g("h1"),o.textContent="Student Bio Data Capture",$=h(),r=g("div"),_(u.$$.fragment),L=h(),_(p.$$.fragment),P=h(),_(d.$$.fragment),G=h(),_(f.$$.fragment),F=h(),_(E.$$.fragment),W=h(),_(R.$$.fragment),H=h(),_(C.$$.fragment),B=h(),y=g("div"),U=g("p"),U.textContent="Student Passport",V=h(),T=g("canvas"),q=h(),x=g("div"),_(D.$$.fragment),j=h(),I=g("div"),t=g("div"),c=g("video"),Z=h(),N=g("div"),_(A.$$.fragment),ee=h(),_(k.$$.fragment),te=h(),_(O.$$.fragment),m(o,"class","font-bold text-lg"),m(U,"class","text-sm"),m(T,"class","h-60 w-60 mt-6 border-2 rounded-lg"),m(T,"id","canvas"),m(r,"class","space-y-6 mt-12"),m(x,"class","mt-10"),m(a,"class","flex flex-col py-12"),m(s,"class","container min-h-screen flex flex-1 flex-col"),m(c,"class","border rounded-lg"),m(c,"id","webcam"),c.autoplay=!0,c.playsInline=!0,m(c,"width","640"),m(c,"height","480"),m(N,"class","flex space-x-5 mt-12"),m(I,"class","container min-h-screen flex flex-col items-center pt-16 w-1/2 border-l border-2"),m(e,"class","flex min-h-screen w-screen")},m(n,J){be(n,e,J),l(e,s),l(s,a),l(a,o),l(a,$),l(a,r),b(u,r,null),l(r,L),b(p,r,null),l(r,P),b(d,r,null),l(r,G),b(f,r,null),l(r,F),b(E,r,null),l(r,W),b(R,r,null),l(r,H),b(C,r,null),l(r,B),l(r,y),l(y,U),l(y,V),l(y,T),i[23](T),l(a,q),l(a,x),b(D,x,null),l(e,j),l(e,I),l(I,t),l(t,c),i[24](c),l(I,Z),l(I,N),b(A,N,null),l(N,ee),b(k,N,null),l(N,te),b(O,N,null),z=!0},p(n,[J]){const he={};u.$set(he);const ue={};p.$set(ue);const pe={};d.$set(pe);const de={};f.$set(de);const fe={};E.$set(fe);const se={};J&512&&(se.options=n[9]),R.$set(se);const ne={};J&1024&&(ne.options=n[10]),C.$set(ne)},i(n){z||(w(u.$$.fragment,n),w(p.$$.fragment,n),w(d.$$.fragment,n),w(f.$$.fragment,n),w(E.$$.fragment,n),w(R.$$.fragment,n),w(C.$$.fragment,n),w(D.$$.fragment,n),w(A.$$.fragment,n),w(k.$$.fragment,n),w(O.$$.fragment,n),z=!0)},o(n){v(u.$$.fragment,n),v(p.$$.fragment,n),v(d.$$.fragment,n),v(f.$$.fragment,n),v(E.$$.fragment,n),v(R.$$.fragment,n),v(C.$$.fragment,n),v(D.$$.fragment,n),v(A.$$.fragment,n),v(k.$$.fragment,n),v(O.$$.fragment,n),z=!1},d(n){n&&we(e),i[16](null),S(u),i[17](null),S(p),i[18](null),S(d),i[19](null),S(f),i[20](null),S(E),i[21](null),S(R),i[22](null),S(C),i[23](null),S(D),i[24](null),S(A),S(k),S(O)}}}function Re(i,e,s){let a,o,$,r,u,L,p,P,d,G,f,F=[],E=[],W=[{placeholder:"PRE-DEGREE SCIENCE",value:"PRE-DEGREE SCIENCE"},{placeholder:"PRE-DEGREE AGRIC",value:"PRE-DEGREE AGRIC"},{placeholder:"PRE-DEGREE ARTS",value:"PRE-DEGREE ARTS"},{placeholder:"PRE-DEGREE EDUCATION",value:"PRE-DEGREE EDUCATION"},{placeholder:"PRE-DEGREE SOCIAL STUDIES",value:"PRE-DEGREE SOCIAL STUDIES"},{placeholder:"PRE-DEGREE MANAGEMENT SCIENCE",value:"PRE-DEGREE MANAGEMENT SCIENCE"},{placeholder:"PRE-DEGREE FRENCH",value:"PRE-DEGREE FRENCH"}];ve(async()=>{$=new Se(a,"user",o),X.get("/api/classes",{onSuccess:t=>{s(9,F=t.data.flatMap(c=>[{placeholder:c.class_name,value:c.id}]))}}),X.get("/api/sessions",{onSuccess:t=>{s(10,E=t.data.flatMap(c=>[{placeholder:c.session,value:c.id}]))}})});const R=()=>{$.start().then(t=>{console.log("webcam started")}).catch(t=>{console.log(t)})},H=()=>{r=$.snap()},C=()=>$.stop(),B=()=>{X.post("/api/student-profile/create",{firstName:u.value,lastName:L.value,regNo:p.value,profilePic:r,level:f.value,session:d.value,programOfStudy:G.value,email:P.value},{onSuccess:t=>{window.location.reload()}})};function y(t){M[t?"unshift":"push"](()=>{u=t,s(2,u)})}function U(t){M[t?"unshift":"push"](()=>{L=t,s(3,L)})}function V(t){M[t?"unshift":"push"](()=>{P=t,s(5,P)})}function T(t){M[t?"unshift":"push"](()=>{p=t,s(4,p)})}function q(t){M[t?"unshift":"push"](()=>{G=t,s(7,G)})}function x(t){M[t?"unshift":"push"](()=>{f=t,s(8,f)})}function D(t){M[t?"unshift":"push"](()=>{d=t,s(6,d)})}function j(t){M[t?"unshift":"push"](()=>{o=t,s(1,o)})}function I(t){M[t?"unshift":"push"](()=>{a=t,s(0,a)})}return[a,o,u,L,p,P,d,G,f,F,E,W,R,H,C,B,y,U,V,T,q,x,D,j,I]}class ye extends ge{constructor(e){super(),Ee(this,e,Re,$e,_e,{})}}export{ye as default};
